{"ast":null,"code":"var _jsxFileName = \"/Users/rishi.arya/Documents/planview-twitter/src/components/dashboard/index.js\",\n    _s = $RefreshSig$();\n\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport { getSearchResults } from \"../../sources\";\nimport { localStorage } from \"../../utils/storage\";\nimport Card from \"../card\";\nimport Tabs from \"../commons/tab\";\nimport Favourite from \"../favourite\";\nimport Search from \"../search\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst Dashboard = () => {\n  _s();\n\n  const [items, setItems] = useState([]);\n  const [favourites, setFavourites] = useState([]);\n  const [selectedTabIndex, setSelectedTabIndex] = useState(0);\n  const [loading, setLoading] = useState(false);\n  const [nextToken, setNextToken] = useState(null);\n  const [query, setQuery] = useState();\n  const [hasMore, setHasMore] = useState(true);\n  const observer = useRef();\n  const lastItemInView = useCallback(node => {\n    var _observer$current;\n\n    if (loading) return;\n    observer.current = new IntersectionObserver(enteries => {\n      var _enteries$;\n\n      if ((_enteries$ = enteries[0]) !== null && _enteries$ !== void 0 && _enteries$.isIntersecting && hasMore) {\n        addItems();\n      }\n    });\n    if (node) observer === null || observer === void 0 ? void 0 : (_observer$current = observer.current) === null || _observer$current === void 0 ? void 0 : _observer$current.observe(node);\n  }, [loading, hasMore]);\n\n  const getItems = async () => {\n    setLoading(true);\n    setItems([]);\n\n    try {\n      var _response$data;\n\n      const response = await getSearchResults(query);\n\n      if ((response === null || response === void 0 ? void 0 : (_response$data = response.data) === null || _response$data === void 0 ? void 0 : _response$data.data.length) > 0) {\n        var _response$data2, _response$data3, _response$data3$meta;\n\n        setHasMore(true);\n        setItems(response === null || response === void 0 ? void 0 : (_response$data2 = response.data) === null || _response$data2 === void 0 ? void 0 : _response$data2.data);\n        setNextToken(response === null || response === void 0 ? void 0 : (_response$data3 = response.data) === null || _response$data3 === void 0 ? void 0 : (_response$data3$meta = _response$data3.meta) === null || _response$data3$meta === void 0 ? void 0 : _response$data3$meta.next_token);\n      }\n\n      setLoading(false);\n    } catch (e) {\n      setHasMore(false);\n      setLoading(false);\n      console.log('error in search api', e);\n    }\n  };\n\n  const addItems = async () => {\n    setLoading(true);\n\n    try {\n      var _response$data4, _response$data5, _response$data5$data;\n\n      const response = await getSearchResults(query, nextToken);\n      const newItems = response === null || response === void 0 ? void 0 : (_response$data4 = response.data) === null || _response$data4 === void 0 ? void 0 : _response$data4.data;\n\n      if ((response === null || response === void 0 ? void 0 : (_response$data5 = response.data) === null || _response$data5 === void 0 ? void 0 : (_response$data5$data = _response$data5.data) === null || _response$data5$data === void 0 ? void 0 : _response$data5$data.length) > 0) {\n        var _updateItems, _response$data6, _response$data6$meta;\n\n        setHasMore(true);\n        let updateItems = [...items];\n        updateItems = (_updateItems = updateItems) === null || _updateItems === void 0 ? void 0 : _updateItems.concat(newItems);\n        setItems(updateItems);\n        setNextToken(response === null || response === void 0 ? void 0 : (_response$data6 = response.data) === null || _response$data6 === void 0 ? void 0 : (_response$data6$meta = _response$data6.meta) === null || _response$data6$meta === void 0 ? void 0 : _response$data6$meta.next_token);\n      } else {\n        setHasMore(false);\n      }\n\n      setLoading(false);\n    } catch (e) {\n      setHasMore(false);\n      setLoading(false);\n      console.log('error in search api', e);\n    }\n  };\n\n  const toChangeTab = index => {\n    setSelectedTabIndex(index);\n  };\n\n  const getFavouriteItems = () => {\n    try {\n      const favItems = localStorage.get('favourite-tweets');\n      favItems && setFavourites(favItems);\n      setLoading(false);\n    } catch (e) {\n      setLoading(false);\n      setFavourites(null);\n      console.log('error fetching items from localhost', e);\n    }\n  };\n\n  useEffect(() => {\n    if (selectedTabIndex === 1) {\n      setLoading(true);\n      setFavourites([]);\n      getFavouriteItems();\n    }\n  }, [selectedTabIndex]);\n\n  const onTermChange = term => {\n    setQuery(term);\n  };\n\n  const tabItems = {\n    display: ['Search', 'Favourites']\n  };\n  const comp = {\n    0: /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Search, {\n        getItems: getItems,\n        query: query,\n        onTermChange: onTermChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 102,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card-container\",\n        children: [(items === null || items === void 0 ? void 0 : items.length) > 0 && items.map((item, id) => id + 1 === items.length ? /*#__PURE__*/_jsxDEV(\"div\", {\n          ref: lastItemInView,\n          children: /*#__PURE__*/_jsxDEV(Card, {\n            data: item,\n            type: \"tweets\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 107,\n            columnNumber: 15\n          }, this)\n        }, item.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 106,\n          columnNumber: 14\n        }, this) : /*#__PURE__*/_jsxDEV(Card, {\n          data: item,\n          type: \"tweets\"\n        }, item.id, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 15\n        }, this)), loading && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"center-loading\",\n          children: \"loading...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 111,\n          columnNumber: 26\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 103,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true),\n    1: /*#__PURE__*/_jsxDEV(Favourite, {\n      toChangeTab: toChangeTab,\n      items: favourites,\n      loading: loading,\n      getFavouriteItems: getFavouriteItems\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 114,\n      columnNumber: 8\n    }, this)\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"sub-container\",\n        children: [/*#__PURE__*/_jsxDEV(Tabs, {\n          items: tabItems,\n          selectedIndex: selectedTabIndex,\n          onTabChange: toChangeTab\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 126,\n          columnNumber: 13\n        }, this), comp === null || comp === void 0 ? void 0 : comp[selectedTabIndex]]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 12\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 8\n    }, this)\n  }, void 0, false);\n};\n\n_s(Dashboard, \"+MGX6q8Xbj2ImkV2ieHWH+Hi9kY=\");\n\n_c = Dashboard;\nexport default Dashboard;\n\nvar _c;\n\n$RefreshReg$(_c, \"Dashboard\");","map":{"version":3,"sources":["/Users/rishi.arya/Documents/planview-twitter/src/components/dashboard/index.js"],"names":["useCallback","useEffect","useRef","useState","getSearchResults","localStorage","Card","Tabs","Favourite","Search","Dashboard","items","setItems","favourites","setFavourites","selectedTabIndex","setSelectedTabIndex","loading","setLoading","nextToken","setNextToken","query","setQuery","hasMore","setHasMore","observer","lastItemInView","node","current","IntersectionObserver","enteries","isIntersecting","addItems","observe","getItems","response","data","length","meta","next_token","e","console","log","newItems","updateItems","concat","toChangeTab","index","getFavouriteItems","favItems","get","onTermChange","term","tabItems","display","comp","map","item","id"],"mappings":"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","sourcesContent":["import { useCallback, useEffect, useRef, useState } from \"react\";\nimport { getSearchResults } from \"../../sources\";\nimport { localStorage } from \"../../utils/storage\";\nimport Card from \"../card\";\nimport Tabs from \"../commons/tab\";\nimport Favourite from \"../favourite\";\nimport Search from \"../search\";\n\nconst Dashboard = ()=>{\nconst [items, setItems] = useState([]);\nconst [favourites, setFavourites] = useState([]);\nconst [selectedTabIndex, setSelectedTabIndex] = useState(0);\nconst [loading, setLoading] = useState(false);\nconst [nextToken, setNextToken] = useState(null);\nconst [query, setQuery] = useState();\nconst [hasMore, setHasMore] = useState(true);\n\nconst observer = useRef();\n\nconst lastItemInView = useCallback((node)=>{\n  if(loading) return;\n  observer.current = new IntersectionObserver(enteries =>{\n       if(enteries[0]?.isIntersecting && hasMore){\n         addItems();\n       }\n  });\n  if(node) observer?.current?.observe(node);\n},[loading, hasMore])\n\nconst getItems = async() =>{\n    setLoading(true);\n    setItems([]);\n  try{ \n    const response =  await getSearchResults(query);\n    if(response?.data?.data.length > 0){ \n      setHasMore(true);\n      setItems(response?.data?.data);\n      setNextToken(response?.data?.meta?.next_token)\n    }\n    setLoading(false);\n  }catch(e){\n    setHasMore(false);\n    setLoading(false);\n    console.log('error in search api',e);\n  }\n}\n\nconst addItems = async()=>{\n  setLoading(true);\n  try{ \n    const response =  await getSearchResults(query, nextToken);\n    const newItems = response?.data?.data;\n    if(response?.data?.data?.length > 0){ \n      setHasMore(true);\n      let updateItems = [...items];\n      updateItems = updateItems?.concat(newItems)\n      setItems(updateItems);\n      setNextToken(response?.data?.meta?.next_token)\n    }else{\n      setHasMore(false);\n    }\n    setLoading(false);\n  }catch(e){\n    setHasMore(false);\n    setLoading(false);\n    console.log('error in search api',e);\n  }\n}\n\nconst toChangeTab =(index)=>{\n    setSelectedTabIndex(index);\n}\n\nconst getFavouriteItems =()=>{\n        try{  \n            const favItems = localStorage.get('favourite-tweets');\n            favItems && setFavourites(favItems);\n            setLoading(false);\n          }\n          catch(e){\n            setLoading(false);\n            setFavourites(null);\n            console.log('error fetching items from localhost',e)\n          }\n}\n\nuseEffect(()=>{\n    if(selectedTabIndex === 1){\n        setLoading(true);\n        setFavourites([]);\n        getFavouriteItems();\n    }\n},[selectedTabIndex])\n\nconst onTermChange =(term)=>{\n  setQuery(term);\n}\n\nconst tabItems = {display:['Search','Favourites']};\nconst comp = {\n  0 :  <>\n        <Search getItems={getItems} query={query} onTermChange={onTermChange}/>\n          <div className='card-container'>\n            { items?.length > 0 && items.map((item,id)=>(\n             (id+1 === items.length) ? \n             <div ref={lastItemInView} key={item.id}> \n              <Card data={item} type='tweets'/> \n             </div> :\n              <Card key={item.id} data={item} type='tweets'/>\n            ))} \n            { loading && <div className='center-loading'>loading...</div>}\n          </div>\n       </>,\n  1 :  <Favourite \n         toChangeTab={toChangeTab}\n         items={favourites}\n         loading={loading} \n         getFavouriteItems={getFavouriteItems}\n        />\n }\n\n   return(\n       <>\n       <div className='container'>\n           <div className='sub-container'>\n            <Tabs\n              items={tabItems}\n              selectedIndex={selectedTabIndex}\n              onTabChange={toChangeTab}\n            />\n            {comp?.[selectedTabIndex]}\n           </div>\n       </div>\n       </>\n   )\n}\n\nexport default Dashboard;"]},"metadata":{},"sourceType":"module"}